<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Database-3." /><meta property="og:locale" content="ko" /><meta name="description" content="뷰" /><meta property="og:description" content="뷰" /><link rel="canonical" href="https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/" /><meta property="og:url" content="https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/" /><meta property="og:site_name" content="yunrap" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-28T20:33:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Database-3." /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-07-01T11:22:06+09:00","datePublished":"2021-06-28T20:33:00+09:00","description":"뷰","headline":"Database-3.","mainEntityOfPage":{"@type":"WebPage","@id":"https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/"},"url":"https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/"}</script><title>Database-3. | yunrap</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="yunrap"><meta name="application-name" content="yunrap"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://yunrap.github.io/assets/img/favicons/스크린샷 2021-05-16 오후 12.19.55.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">yunrap</a></div><div class="site-subtitle font-italic">개발 일기</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/yunrap" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dbsdpwl7','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-5" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Database-3.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Database-3.</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> yunrap </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Jun 28, 2021, 8:33 PM +0900" prep="on" > Jun 28, 2021 <i class="unloaded">2021-06-28T20:33:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 1, 2021, 11:22 AM +0900" prefix="Updated " > Jul 1, 2021 <i class="unloaded">2021-07-01T11:22:06+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3421 words">19 min</span></div></div><div class="post-content"><h1 id="뷰">뷰</h1><p>하나의 가상테이블 이다. SELECT 문으로 조회된값으로 가상의 VIEW를 만들어내는것이다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>GRANT CREATE VIEW TO SCOTT;  // icia_sys에서 입력

CREATE OR REPLACE VIEW v_emp as
SELECT EMPNO, ENAME, JOB, DEPTNO
FROM EMP
WHERE EMPNO = 7369;

SELECT *
FROM EMP_TEMP T, v_emp V
WHERE T.EMPNO  = V.EMPNO;
</pre></table></code></div></div><h1 id="인덱스">인덱스</h1><p>데이터베이스 테이블에 있는 데이터를 빨리 찾기 위한 용도의 데이터베이스</p><p>프라이머리 키는 반드시 UNIQUE이다.</p><ol><li><p>유니크 인덱스 테이블에 하나 이상의 같은 데이터 값이 입력되는것을 막아줌</p><li><p>비유일 인덱스</p></ol><p>인덱스 관리 (USER_INDEXES, USER_IND_COLUMNS, USER_COL_COMMENTS)</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>--인덱스
SELECT * FROM USER_INDEXES;

--인덱스 네임기준
SELECT * FROM USER_IND_COLUMNS;

CREATE INDEX IDX_EMP_MGR_GRADE ON
EMP(MGR, GRADE);
</pre></table></code></div></div><ol><li>리빌드 해당 테이블이 빈번하게 일어날때 인덱스 리빌드를 해준다.</ol><p>인덱스 사용시 주의사항 테이블 조회 속도를 향상시키기위한 용도로 너무 많은 인덱스는 피해야한다. 또한 인덱스 컬럼으로 컬럼의 중복을 최소화 해야함</p><h1 id="시퀀스">시퀀스</h1><p>여러 사용자에게 유일한 값을 생성해 주는 오라클객체</p><p>cycle : 최대값까지 증가후 최소값으로 돌아가는 옵션</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>SELECT MAX(EMPNO) FROM EMP;

--시퀀스
CREATE SEQUENCE EMP_EMPNO_SEQ
START WITH 7935
INCREMENT BY 1
MINVALUE 1
MAXVALUE 9999
NOCYCLE
NOCACHE;

SELECT EMP_EMPNO_SEQ.NEXTVAL --CURRVAL
FROM DUAL;



-- INSERT INTO EMP VALUES ((SELECT MAX(EMPNO)+1 FROM EMP))
-- 이방법이아닌
INSERT INTO EMP VALUES (EMP_EMPNO_SEQ.NEXTVAL, '김대경', '사원', 7902, TO_DATE('20210504', 'YYYYMMDD'), 1200, 0, 10, 1);

INSERT INTO EMP VALUES (EMP_EMPNO_SEQ.NEXTVAL, '윤예지', '사원', 7902, SYSDATE, 3000,0,20,5);

COMMIT;

</pre></table></code></div></div><p>BONUS (직원이름, 직업, 연봉, 보너스)</p><p>EMP (직원번호, 직원이름, 직업, 매니저번호, 고용일자, 연봉, 보너스, 부서번호, 등급) SALGRADE (등급, 최저금액, 최고금액) DEPT (부서번호, 부서이름, 지역) BONUS (직원이름, 직업, 연봉, 보너스)</p><p>EMP 테이블 보너스삭제, 부서번호삭제, 등급삭제 BONUS 직원이름, 직업,</p><p>EMP (직원번호, 직원이름, 직책, 매니저번호, 고용일자, 부서번호, 등급) BONUS (급여액(년(6자리), 월, 직원번호), 보너스(년, 월, 직원번호)) DEPT (부서번호, 부서이름, 지역) SALGRADE (등급, 최저금액, 최고금액)</p><h1 id="테이블만들기">테이블만들기</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
</pre><td class="rouge-code"><pre>--고정길이 CHAR
--가변길이 VARCHAR2
CREATE TABLE EMP(
    EMPNO NUMBER NOT NULL, 
    Ename VARCHAR2(10),
    Job VARCHAR2(9),
    Mgr NUMBER(4),
    Hiredate DATE,
    Deptno NUMBER(2) NOT NULL,
    GRADE NUMBER(1)
);

// 프라이머리 키 만들어주기
ALTER TABLE EMP ADD CONSTRAINT PK_EMPNO PRIMARY KEY(EMPNO);

// COMMENT 달아주기
COMMENT ON TABLE EMP IS '사원정보';

COMMENT ON COLUMN EMP.EMPNO IS '사원번호';
COMMENT ON COLUMN EMP.ENAME IS '사원이름';
COMMENT ON COLUMN EMP.JOB IS '직책';
COMMENT ON COLUMN EMP.MGR IS '매니저';
COMMENT ON COLUMN EMP.HIREDATE IS '입사일';
COMMENT ON COLUMN EMP.DEPTNO IS '부서번호';
COMMENT ON COLUMN EMP.GRADE IS '등급';

// DEPT 테이블 만들어주기
CREATE TABLE DEPT(
    DEPTNO NUMBER(2,0) NOT NULL,
    DNAME VARCHAR2(14),
    LOC VARCHAR2(13),
    CONSTRAINT PK_DEPT PRIMARY KEY(DEPTNO)
);

// DEPT 테이블 COMMENT달아주기
COMMENT ON TABLE DEPT IS '부서코드';

COMMENT ON COLUMN DEPT.DEPTNO IS '부서코드';
COMMENT ON COLUMN DEPT.DNAME IS '부서명';
COMMENT ON COLUMN DEPT.LOC IS '부서위치';


// SALGRADE 생성
CREATE TABLE SALGRADE
(
    GRADE NUMBER,
    LOSAL NUMBER,
    HISAL NUMBER
);

// SALGRADE 테이블 COMMENT 생성
COMMENT ON COLUMN SALGRADE.GRADE IS '등급';
COMMENT ON COLUMN SALGRADE.LOSAL IS '최저급여';
COMMENT ON COLUMN SALGRADE.HISAL IS '최고급여';

// SALGRADE PK 생성
ALTER TABLE SALGRADE ADD CONSTRAINT PK_GRADE PRIMARY KEY(GRADE);


// BONUS 테이블 생성
CREATE TABLE BONUS
(
    PAYMONTH CHAR(6) NOT NULL,
    EMPNO NUMBER(4) NOT NULL,
    SAL NUMBER(7,2),
    COMM NUMBER(7,2),
    CONSTRAINT PK_BONUS PRIMARY KEY(PAYMONTH, EMPNO)
)

// BONUS 테이블 COMMENT 생성
COMMENT ON TABLE BONUS IS '급여';
COMMENT ON COLUMN BONUS.PAYMONTH IS '급여년월';
COMMENT ON COLUMN BONUS.EMPNO IS '직원번호';
COMMENT ON COLUMN BONUS.SAL IS '급여액';
COMMENT ON COLUMN BONUS.COMM IS '보너스';

--FK
ALTER TABLE EMP
ADD CONSTRAINTS FK_MGR FOREIGN KEY(MGR)
REFERENCES EMP(EMPNO);

ALTER TABLE EMP
ADD CONSTRAINT FK_EMP_DEPTNO FOREIGN KEY(DEPTNO)
REFERENCES DEPT(DEPTNO);

ALTER TABLE EMP
ADD CONSTRAINT FK_EMP_GRADE FOREIGN KEY(GRADE)
REFERENCES SALGRADE(GRADE);

ALTER TABLE BONUS
ADD CONSTRAINT FK_BONUS_EMP FOREIGN KEY(EMPNO)
REFERENCES EMP(EMPNO);

</pre></table></code></div></div><h1 id="외래키는-왜사용할까">외래키는 왜사용할까?</h1><p>왜 외래키가 필요할까 알아보자</p><p>우리가 온라인 식료품 마트를 운영하고 있다고 가정해보자, 온라인 식료퓸 마트는 사용자로부터 주문을 받아서 배송해주는 시스템을 운영한다.</p><p>먼저, 사용자에 대한 정보를 저장하기위해 이런조건의 테이블이 필요할것이다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>아이디, 비밀번호, 이름, 성별, 배송주소
</pre></table></code></div></div><p>온라인마켓이다보니 위의 정보만으로 주문정보를 저장할수없으므로</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>주문 일자, 제품 id, 제품명, 수량
</pre></table></code></div></div><p>그렇다면 이렇게 테이블이 생길것입니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/favicons/foreign_table1.png" alt="Desktop View" /></p><p>당장에는 문제가없을것이다. 하지만 한 user가 주문을 추가할때마다 데이터의 중복이 심해지기때문에 큰 비효율을 발생시키는 테이블 구조이다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/favicons/foreign_table2.png" alt="Desktop View" /></p><p>이렇게 빨간색으로 보이는 중복데이터가 많아진다는것이다. 그래서 이문제를 해결하기위한 방법으로 테이블을 사용자, 주문테이블로 나뉘어서 데이터를 저장하면된다.</p><h2 id="분리된테이블">분리된테이블</h2><h3 id="사용자-테이블">사용자 테이블</h3><p>사용자 테이블은 사용자에 해당하는 정보만 가지고있으면 된다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/favicons/foreign_table3.png" alt="Desktop View" /></p><h3 id="주문-테이블">주문 테이블</h3><p>주문테이블은 주문을 관리하는 테이블로 주문과 관련된 정보만 가지고 있으면 된다. 하지만, 이렇게 테이블을 만들면 큰 문제가 발생한다. 주문정보는 추가되는데 누가 주문을 했는지 알수있는 방법이 없다는 것이다.</p><p>이문제를 해결하기 위해서 사용자 테이블의 기본키 정보만 주문 테이블이 가지고있으면 사용자를 찾을수있다. 따라서 주문테이블의 위의 사용자테이블의 기본키를 추가하면, 중복된 데이터없이 데이터를 저장관리할수있다는것이다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/favicons/foreign_table5.png" alt="Desktop View" /></p><p>이게 바로 주문테이블에 존재하는 user_id를 우리는 외래키라고 부른다.</p><p>즉 요약한다면 외래키는 두개의 테이블을 연결하는 역활을하며, 참조하는 테이블에 무결성을 높여주는 역활을 한다.</p><h1 id="테이블-분석하기">테이블 분석하기</h1><p>점선과 실선차이</p><p>점선은 부모는 PK 자식은 속성 실선은 부모는 pk 자식도 pk</p><p>보통 프라이머리키는 데이타타입이 CHAR TYPE, NUMBER TYPE 이 많다.</p><h2 id="bonus">BONUS</h2><p>현재 : (PAYMONTH, EMPNO, SAL, COMM) empno pk와<br /> 직원의 전 월급</p><h1 id="시퀀스-생성">시퀀스 생성</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>CREATE SEQUENCE EMP_EMPNO_SEQ
START WITH 7935
INCREMENT BY 1
MINVALUE 1
MAXVALUE 9999
NOCYCLE
NOCACHE;
</pre></table></code></div></div><h1 id="데이터-추가">데이터 추가</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
</pre><td class="rouge-code"><pre>1. 첫번째순서
--GRADE 추가
--1 : 1000 ~ 2000
--2 : 2100 ~ 4000
--3 : 4100 ~ 6000
--4 : 6100 ~ 7500
--5 : 7600 ~ 9500

INSERT INTO SALGRADE VALUES (1, 1000, 2000);
INSERT INTO SALGRADE VALUES (2, 2100, 4000);
INSERT INTO SALGRADE VALUES (3, 4100, 6000);
INSERT INTO SALGRADE VALUES (4, 6100, 7500);
INSERT INTO SALGRADE VALUES (5, 7600, 9500);

COMMIT;

2. 두번째순서
--DEPT 추가
--10 : 총무팀 학익동 
--20 : 인사팀 연수구
--30 : 전산팀 강남구
--40 : 영업팀 강북구
--50 : 경리팀 부평구

INSERT INTO DEPT VALUES (10, '총무팀', '학익동');
INSERT INTO DEPT VALUES (20, '인사팀', '연수구');
INSERT INTO DEPT VALUES (30, '전산팀', '강남구');
INSERT INTO DEPT VALUES (40, '영업팀', '강북구');
INSERT INTO DEPT VALUES (50, '경리팀', '부평구');

COMMIT;

3. 세번째순서

--EMP 추가

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '홍길동', '사원', SYSDATE, 30, 1);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '장동건', '부장', TO_DATE('20100308','YYYYMMDD'), 10, 5);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '고소영', '차장', TO_DATE('20110504','YYYYMMDD'), 20, 4);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '설현', '과장', TO_DATE('20100308','YYYYMMDD'), 40, 3);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야1', '대리', TO_DATE('20110504','YYYYMMDD'), 50, 2);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야2', '사원', TO_DATE('20110308','YYYYMMDD'), 10, 1);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야3', '사원', TO_DATE('20111108','YYYYMMDD'), 10, 1);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야4', '사원', TO_DATE('20111208','YYYYMMDD'), 20, 1);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야5', '사원', TO_DATE('20110308','YYYYMMDD'), 10, 1);

INSERT INTO EMP (EMPNO, ENAME, JOB, HIREDATE, DEPTNO, GRADE)
VALUES (EMP_EMPNO_SEQ.NEXTVAL, '나야6', '사원', TO_DATE('20100308','YYYYMMDD'), 40, 1);


4. 네번째 순서
--BONUS 추가
INSERT INTO BONUS VALUES('202106', 7935, 1000, 0);
INSERT INTO BONUS VALUES('202106', 7936, 9200, 0);
INSERT INTO BONUS VALUES('202106', 7937, 7500, 0);
INSERT INTO BONUS VALUES('202106', 7945, 1000, 0);
INSERT INTO BONUS VALUES('202106', 7939, 1200, 0);
INSERT INTO BONUS VALUES('202106', 7940, 1300, 0);
INSERT INTO BONUS VALUES('202106', 7941, 1400, 0);
INSERT INTO BONUS VALUES('202106', 7942, 1200, 0);
INSERT INTO BONUS VALUES('202106', 7943, 2200, 0);
INSERT INTO BONUS VALUES('202106', 7944, 4200, 0);


--조회
--부서별 직원수
select deptno, count(*)
from emp
group by deptno
order by deptno ASC;

--부서코드 부서명 직원수
SELECT DEPTNO, DNAME, COUNT(*)
FROM DEPT D
GROUP BY DEPTNO, DNAME;

--인라인 뷰를 이용
--SUBQUERY를 이용해서 JOIN
SELECT D.DEPTNO 부서코드, D.DNAME 부서명, E.CNT 직원수
    FROM DEPT D, (select deptno, count(DEPTNO) CNT
                    from emp
                    group by deptno
                    order by deptno ASC) E
WHERE D.DEPTNO = E.DEPTNO;

--EQUI JOIN
SELECT E.DEPTNO AS "부서 코드", D.DNAME 부서명, COUNT(D.DNAME) 직원수
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
GROUP BY E.DEPTNO, D.DNAME
ORDER BY E.DEPTNO ASC;


select deptno, count(*)
from emp
group by deptno
order by deptno ASC;

--직원별 이번달 급여액과 보너스를 합하여 조회 하고 받을수 있는 최저급여액과
-- 최대급여액 조회
--조회항목 : 직원번호, 직원명, 월 급여, 최저급여액, 최대급여액

SELECT *
FROM SALGRADE;


SELECT E.EMPNO 직원번호, E.ENAME 직원명, B.SAL + B.COMM "월 급여액",
        S.LOSAL 최저급여액, S.HISAL 최대급여액
    FROM EMP E, BONUS B, SALGRADE S
    WHERE E.EMPNO = B.EMPNO 
   -- AND B.PAYMONTH = TO_CHAR(SYSDATE, 'YYYYMM')
    AND E.GRADE = S.GRADE;

-- DUAL 테이블 사용해서 연습해보기
SELECT TO_CHAR(SYSDATE, 'YYYY-MM-DD')
FROM DUAL;


--지난달 직원별 급여액과 보너스를 합하여 조회 하고 받을수 있는 최저급여액과
-- 최대급여액 조회
--조회항목 : 직원번호, 직원명, 월 급여, 최저급여액, 최대급여액

SELECT E.EMPNO 직원번호, E.ENAME 직원명, B.SAL + B.COMM "월 급여액",
        S.LOSAL 최저급여액, S.HISAL 최대급여액, B.PAYMONTH
    FROM EMP E, BONUS B, SALGRADE S
    WHERE B.PAYMONTH = TO_CHAR(ADD_MONTHS(SYSDATE, -1), 'YYYYMM')
    AND E.EMPNO = B.EMPNO
    AND E.GRADE = S.GRADE;
    
    SELECT TO_CHAR(ADD_MONTHS(SYSDATE, -1), 'YYYY-MM-DD')
    FROM DUAL;


--직원들에 대한 지난달 직원별 급여액과 보너스를 합하여 조회하고 받을수 있는
--최저급여액과 최대급여액 조회 (단, 지난달 해당직원이 아닌경우는 0원처리)
--조회항목 : 직원번호, 직원명, 월 급여, 최저급여액, 최대급여액
--OUTER 조인이해
--OUTER 조인걸어준것은 다 걸어줘야한다.

SELECT E.EMPNO 직원번호, E.ENAME 직원명, NVL(B.SAL + B.COMM, 0) "월 급여액",
        S.LOSAL 최저급여액, S.HISAL 최대급여액, B.PAYMONTH
FROM EMP E, BONUS B, SALGRADE S
WHERE E.EMPNO = B.EMPNO(+)
AND B.PAYMONTH(+) = TO_CHAR(ADD_MONTHS(SYSDATE, -1), 'YYYYMM')
AND E.GRADE = S.GRADE;


--급여 추가
INSERT INTO BONUS VALUES('202105', 7935, 1000, 0);
INSERT INTO BONUS VALUES('202105', 7936, 9200, 0);
INSERT INTO BONUS VALUES('202105', 7937, 7500, 0);
INSERT INTO BONUS VALUES('202105', 7945, 1000, 0);
INSERT INTO BONUS VALUES('202105', 7939, 1200, 0);
INSERT INTO BONUS VALUES('202105', 7940, 1300, 0);
INSERT INTO BONUS VALUES('202105', 7941, 1400, 0);
INSERT INTO BONUS VALUES('202105', 7942, 1200, 0);
INSERT INTO BONUS VALUES('202105', 7943, 2200, 0);
INSERT INTO BONUS VALUES('202105', 7944, 4200, 0);

SELECT *
FROM BONUS;

COMMIT;

</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>-- 직원번호, 직원명, 총급여액, 총건수
--서브쿼리사용


-- 직원번호, 직원명, 총급여액, 총건수
SELECT E.EMPNO 직원번호, E.ENAME 직원명, B.SAL 총급여액, B.CNT 총건수
FROM EMP E, (
                SELECT EMPNO, SUM(SAL) SAL, COUNT(EMPNO) CNT
                FROM BONUS
                GROUP BY EMPNO
            ) B
WHERE E.EMPNO = B.EMPNO; 
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/language/'>Language</a>, <a href='/categories/database/'>Database</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/database/" class="post-tag no-text-decoration" >Database</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Database-3. - yunrap&url=https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Database-3. - yunrap&u=https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Database-3. - yunrap&url=https://yunrap.github.io/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A43/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>최근 업데이트</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98-Chunk-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%9D%B4%ED%95%B4/">스프링배치 Chunk 프로세스 이해</a><li><a href="/posts/%EB%B0%94%EB%8B%90%EB%9D%BC-JS-%EC%B1%8C%EB%A6%B0%EC%A7%803/">바닐라 JS 챌린지 3</a><li><a href="/posts/%EB%B0%94%EB%8B%90%EB%9D%BC-JS-%EC%B1%8C%EB%A6%B0%EC%A7%804/">바닐라 JS 챌린지 4</a><li><a href="/posts/%EB%B0%94%EB%8B%90%EB%9D%BC-JS-%EC%B1%8C%EB%A6%B0%EC%A7%805/">바닐라 JS 챌린지 5</a><li><a href="/posts/%EB%B0%94%EB%8B%90%EB%9D%BC-JS-%EC%B1%8C%EB%A6%B0%EC%A7%806/">바닐라 JS 챌린지 6</a></ul></div><div id="access-tags"> <span>인기 태그</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/javascript/">Javascript</a> <a class="post-tag" href="/tags/%EB%B0%94%EB%8B%90%EB%9D%BCjs/">바닐라JS</a> <a class="post-tag" href="/tags/spring-project/">spring_project</a> <a class="post-tag" href="/tags/basic-project/">basic_project</a> <a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/spring/">SPRING</a> <a class="post-tag" href="/tags/jquery/">jQuery</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/diagram/">diagram</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">목차</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>이 블로그 다른 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%ED%8F%AC%EB%93%9C%ED%8F%AC%EC%9B%8C%EB%94%A9/"><div class="card-body"> <span class="timeago small" > Jun 17, 2021 <i class="unloaded">2021-06-17T20:33:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Database-0. 포드포워딩, 아이피주소</h3><div class="text-muted small"><p> 아이피 주소란? 아이피 주소는 공인 아이피와 사설 아이피 이렇게 두가지 종류가있습니다. 공인아이피 쉽게말하면 네이버에서 IP주소를 확인했을때나오는 주소가 공인아이피라고 생각하면된다. 즉, 인터넷상에서 접속될때 세계에서 유일하고 고유한 주소로, 혼자사용하고 다른사람들이 그주소를 가지고 자기를 찾아올수있다 사설아이피 내부망에서 다시 일정한 주소로...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4/"><div class="card-body"> <span class="timeago small" > Jun 18, 2021 <i class="unloaded">2021-06-18T20:33:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Database-1. 데이터베이스 명령어</h3><div class="text-muted small"><p> 계정, 설정하기 초기계정(sys) 이름 : system 비밀번호 : Icia1008 scott계정 // 접속설정을해준다. scott 이름 : scott 비밀번호 : tiger //그후 명령어설정을 해준다. (sys계정에서) CREATE USER scott IDENTIFIED BY tiger; GRANT DBA TO scott; icia...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A42/"><div class="card-body"> <span class="timeago small" > Jun 27, 2021 <i class="unloaded">2021-06-27T20:33:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Database-2. 데이터베이스 함수와 조인</h3><div class="text-muted small"><p> 집계함수 COUNT : 검색되는 데이터 수를 반환 MAX : 선택된 컬럼 값 중에서 최대값 반환 MIN : 선택된 컬럼 값 중에서 최소값 반환 집계함수 SELECT COUNT(EMPNO), MAX(SAL), MIN(SAL), AVG(SAL), SUM(SAL) FROM EMP WHERE JOB = 'MANAGER'; 데이터 그룹핑 특정 컬럼기...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A42/" class="btn btn-outline-primary" prompt="이전"><p>Database-2. 데이터베이스 함수와 조인</p></a> <a href="/posts/PLSQL/" class="btn btn-outline-primary" prompt="다음"><p>PL/SQL.</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">yunrap</a>. <span data-toggle="tooltip" data-placement="top" title="다르게 명시되지 않는 한, 크리에이티브 커먼즈 저작자표시-비영리 4.0 (CC BY-NC 4.0) 국제 라이선스에 따라 저자는 저작물에 대한 라이선스를 가지며, 라이선스에 따라 이용할 수 있습니다.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">인기 태그</h4><a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/javascript/">Javascript</a> <a class="post-tag" href="/tags/%EB%B0%94%EB%8B%90%EB%9D%BCjs/">바닐라JS</a> <a class="post-tag" href="/tags/spring-project/">spring_project</a> <a class="post-tag" href="/tags/basic-project/">basic_project</a> <a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/spring/">SPRING</a> <a class="post-tag" href="/tags/jquery/">jQuery</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/diagram/">diagram</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://yunrap.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
